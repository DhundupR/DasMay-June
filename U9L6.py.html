<html>
<head>
<title>U9L6.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #bcbec4;}
.s1 { color: #cf8e6d;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #2aacb8;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
U9L6.py</font>
</center></td></tr></table>
<pre>

<span class="s1">import </span><span class="s0">mysql</span><span class="s2">.</span><span class="s0">connector</span>








<span class="s1">def </span><span class="s0">getTeacherName</span><span class="s2">(</span><span class="s0">TeacherID</span><span class="s2">):</span>
   <span class="s0">connection </span><span class="s2">= </span><span class="s0">mysql</span><span class="s2">.</span><span class="s0">connector</span><span class="s2">.</span><span class="s0">connect</span><span class="s2">(</span><span class="s0">user</span><span class="s2">=</span><span class="s3">'dhundupr2'</span><span class="s2">,</span>
                                        <span class="s0">password</span><span class="s2">=</span><span class="s3">'233048966'</span><span class="s2">,</span>
                                        <span class="s0">host</span><span class="s2">=</span><span class="s3">'10.8.37.226'</span><span class="s2">,</span>
                                        <span class="s0">database</span><span class="s2">=</span><span class="s3">'dhundupr2_db'</span><span class="s2">)</span>
   <span class="s0">cursor </span><span class="s2">= </span><span class="s0">connection</span><span class="s2">.</span><span class="s0">cursor</span><span class="s2">()</span>
   <span class="s0">query </span><span class="s2">= </span><span class="s3">&quot;select TeacherName from Teacher where TeacherID = &quot;</span><span class="s2">+</span><span class="s0">TeacherID</span><span class="s2">+</span><span class="s3">&quot;&quot;</span>
   <span class="s0">cursor</span><span class="s2">.</span><span class="s0">execute</span><span class="s2">(</span><span class="s0">query</span><span class="s2">)</span>
   <span class="s1">for </span><span class="s0">row </span><span class="s1">in </span><span class="s0">cursor</span><span class="s2">:</span>
       <span class="s0">teacher</span><span class="s2">=</span><span class="s0">row;</span>
   <span class="s0">cursor</span><span class="s2">.</span><span class="s0">close</span><span class="s2">()</span>
   <span class="s0">connection</span><span class="s2">.</span><span class="s0">close</span><span class="s2">()</span>
   <span class="s1">return </span><span class="s0">teacher;</span>




<span class="s1">def </span><span class="s0">getResults</span><span class="s2">(</span><span class="s0">StudentID</span><span class="s2">):</span>
   <span class="s0">connection </span><span class="s2">= </span><span class="s0">mysql</span><span class="s2">.</span><span class="s0">connector</span><span class="s2">.</span><span class="s0">connect</span><span class="s2">(</span><span class="s0">user</span><span class="s2">=</span><span class="s3">'dhundupr2'</span><span class="s2">,</span>
                                        <span class="s0">password</span><span class="s2">=</span><span class="s3">'233048966'</span><span class="s2">,</span>
                                        <span class="s0">host</span><span class="s2">=</span><span class="s3">'10.8.37.226'</span><span class="s2">,</span>
                                        <span class="s0">database</span><span class="s2">=</span><span class="s3">'dhundupr2_db'</span><span class="s2">)</span>
   <span class="s0">cursor </span><span class="s2">= </span><span class="s0">connection</span><span class="s2">.</span><span class="s0">cursor</span><span class="s2">()</span>
   <span class="s0">query </span><span class="s2">= </span><span class="s3">&quot;select Period, Room,CourseName,TeacherID from (select OfferedCourseID from Roster where StudentID = &quot;</span><span class="s2">+</span><span class="s0">StudentID</span><span class="s2">+</span><span class="s3">&quot;) as c inner join OfferedCourse on c.OfferedCourseID = OfferedCourse.OfferedCourseID group by c.OfferedCourseID order by Period&quot;</span>
   <span class="s0">cursor</span><span class="s2">.</span><span class="s0">execute</span><span class="s2">(</span><span class="s0">query</span><span class="s2">)</span>
   <span class="s0">OfferedCourseList </span><span class="s2">= []</span>
   <span class="s1">for </span><span class="s0">row </span><span class="s1">in </span><span class="s0">cursor</span><span class="s2">:</span>
       <span class="s0">OfferedCourseList</span><span class="s2">.</span><span class="s0">append</span><span class="s2">(</span><span class="s0">row</span><span class="s2">)</span>
   <span class="s0">cursor</span><span class="s2">.</span><span class="s0">close</span><span class="s2">()</span>
   <span class="s0">connection</span><span class="s2">.</span><span class="s0">close</span><span class="s2">()</span>


   <span class="s1">return </span><span class="s0">OfferedCourseList</span>


<span class="s1">def </span><span class="s0">printTeacher</span><span class="s2">(</span><span class="s0">TeacherID</span><span class="s2">):</span>
    <span class="s0">connection </span><span class="s2">= </span><span class="s0">mysql</span><span class="s2">.</span><span class="s0">connector</span><span class="s2">.</span><span class="s0">connect</span><span class="s2">(</span><span class="s0">user</span><span class="s2">=</span><span class="s3">'dhundupr2'</span><span class="s2">,</span>
                                         <span class="s0">password</span><span class="s2">=</span><span class="s3">'233048966'</span><span class="s2">,</span>
                                         <span class="s0">host</span><span class="s2">=</span><span class="s3">'10.8.37.226'</span><span class="s2">,</span>
                                         <span class="s0">database</span><span class="s2">=</span><span class="s3">'dhundupr2_db'</span><span class="s2">)</span>
    <span class="s0">cursor </span><span class="s2">= </span><span class="s0">connection</span><span class="s2">.</span><span class="s0">cursor</span><span class="s2">()</span>
    <span class="s0">TeachersID </span><span class="s2">= </span><span class="s0">str</span><span class="s2">(</span><span class="s0">TeacherID</span><span class="s2">)</span>
    <span class="s0">query2 </span><span class="s2">= </span><span class="s3">&quot;call TeacherByID( &quot; </span><span class="s2">+  </span><span class="s0">TeachersID </span><span class="s2">+ </span><span class="s3">&quot;)&quot;</span>
    <span class="s0">cursor</span><span class="s2">.</span><span class="s0">execute</span><span class="s2">(</span><span class="s0">query2</span><span class="s2">)</span>
    <span class="s0">teacherName </span><span class="s2">= </span><span class="s3">&quot;&quot;</span>
    <span class="s1">for </span><span class="s0">rows </span><span class="s1">in </span><span class="s0">cursor</span><span class="s2">:</span>
        <span class="s0">teacherName </span><span class="s2">= </span><span class="s0">rows</span>
    <span class="s0">cursor</span><span class="s2">.</span><span class="s0">close</span><span class="s2">()</span>
    <span class="s0">connection</span><span class="s2">.</span><span class="s0">close</span><span class="s2">()</span>
    <span class="s1">return </span><span class="s0">teacherName</span><span class="s2">[</span><span class="s4">0</span><span class="s2">]</span>



<span class="s0">studentID </span><span class="s2">= </span><span class="s0">input</span><span class="s2">(</span><span class="s3">&quot;Enter A Student ID: &quot;</span><span class="s2">)</span>
<span class="s0">result </span><span class="s2">= </span><span class="s0">getResults</span><span class="s2">(</span><span class="s0">studentID</span><span class="s2">)</span>
<span class="s0">print</span><span class="s2">(</span><span class="s0">result</span><span class="s2">)</span>
<span class="s1">for </span><span class="s0">row </span><span class="s1">in </span><span class="s0">result</span><span class="s2">:</span>
    <span class="s0">print</span><span class="s2">(</span><span class="s3">&quot;Period:&quot;</span><span class="s2">, </span><span class="s0">row</span><span class="s2">[</span><span class="s4">0</span><span class="s2">])</span>
    <span class="s0">print</span><span class="s2">(</span><span class="s3">&quot;Course:&quot;</span><span class="s2">, </span><span class="s0">row</span><span class="s2">[</span><span class="s4">2</span><span class="s2">])</span>
    <span class="s0">print</span><span class="s2">(</span><span class="s3">&quot;Room:&quot;</span><span class="s2">, </span><span class="s0">row</span><span class="s2">[</span><span class="s4">1</span><span class="s2">])</span>
    <span class="s0">teacherName </span><span class="s2">= </span><span class="s0">printTeacher</span><span class="s2">(</span><span class="s0">row</span><span class="s2">[</span><span class="s4">3</span><span class="s2">])</span>
    <span class="s0">print</span><span class="s2">(</span><span class="s3">&quot;Teacher:&quot;</span><span class="s2">, </span><span class="s0">teacherName</span><span class="s2">)</span>
    <span class="s0">print</span><span class="s2">(</span><span class="s3">&quot;&quot;</span><span class="s2">)</span>





</pre>
</body>
</html>